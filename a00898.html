<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>parafields-core: parafields::DFTMatrixBackend&lt; Traits &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">parafields-core
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="a00066.html">parafields</a></li><li class="navelem"><a class="el" href="a00898.html">DFTMatrixBackend</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="a00895.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">parafields::DFTMatrixBackend&lt; Traits &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="a01006.html" title="Covariance matrix for stationary Gaussian random fields.">Matrix</a> backend that uses discrete Fourier transform (DFT)  
 <a href="a00898.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="a00014_source.html">dftmatrixbackend.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae2058da1584ccbf3eddefd878d77b62a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#ae2058da1584ccbf3eddefd878d77b62a">DFTMatrixBackend</a> (const std::shared_ptr&lt; Traits &gt; &amp;traits_)</td></tr>
<tr class="memdesc:ae2058da1584ccbf3eddefd878d77b62a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="a00898.html#ae2058da1584ccbf3eddefd878d77b62a">More...</a><br /></td></tr>
<tr class="separator:ae2058da1584ccbf3eddefd878d77b62a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a554d2e5fa1de5d77331cb39e0f00e783"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#a554d2e5fa1de5d77331cb39e0f00e783">~DFTMatrixBackend</a> ()</td></tr>
<tr class="memdesc:a554d2e5fa1de5d77331cb39e0f00e783"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="a00898.html#a554d2e5fa1de5d77331cb39e0f00e783">More...</a><br /></td></tr>
<tr class="separator:a554d2e5fa1de5d77331cb39e0f00e783"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f867215ac7f71c926568e5ac6a64595"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#a8f867215ac7f71c926568e5ac6a64595">update</a> ()</td></tr>
<tr class="separator:a8f867215ac7f71c926568e5ac6a64595"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf9fbdba9b2dd2f206dd83c53834d968"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#acf9fbdba9b2dd2f206dd83c53834d968">valid</a> () const</td></tr>
<tr class="memdesc:acf9fbdba9b2dd2f206dd83c53834d968"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether matrix has already been created.  <a href="a00898.html#acf9fbdba9b2dd2f206dd83c53834d968">More...</a><br /></td></tr>
<tr class="separator:acf9fbdba9b2dd2f206dd83c53834d968"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0320529369704c414123291cd643d66"><td class="memItemLeft" align="right" valign="top">Index&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#aa0320529369704c414123291cd643d66">localMatrixSize</a> () const</td></tr>
<tr class="memdesc:aa0320529369704c414123291cd643d66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of matrix entries stored on this processor.  <a href="a00898.html#aa0320529369704c414123291cd643d66">More...</a><br /></td></tr>
<tr class="separator:aa0320529369704c414123291cd643d66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa107d13262d2fee4989b211e62b0da9d"><td class="memItemLeft" align="right" valign="top">const Indices &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#aa107d13262d2fee4989b211e62b0da9d">localMatrixCells</a> () const</td></tr>
<tr class="memdesc:aa107d13262d2fee4989b211e62b0da9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of entries per dim on this processor.  <a href="a00898.html#aa107d13262d2fee4989b211e62b0da9d">More...</a><br /></td></tr>
<tr class="separator:aa107d13262d2fee4989b211e62b0da9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa95bb896931308831dbe07332654ed9c"><td class="memItemLeft" align="right" valign="top">const Indices &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#aa95bb896931308831dbe07332654ed9c">localMatrixOffset</a> () const</td></tr>
<tr class="memdesc:aa95bb896931308831dbe07332654ed9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Offset between local indices and global indices per dim.  <a href="a00898.html#aa95bb896931308831dbe07332654ed9c">More...</a><br /></td></tr>
<tr class="separator:aa95bb896931308831dbe07332654ed9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad875611beaa8c3103ee742338fd157ef"><td class="memItemLeft" align="right" valign="top">const Indices &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#ad875611beaa8c3103ee742338fd157ef">localEvalMatrixCells</a> () const</td></tr>
<tr class="memdesc:ad875611beaa8c3103ee742338fd157ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of logical entries per dim on this processor.  <a href="a00898.html#ad875611beaa8c3103ee742338fd157ef">More...</a><br /></td></tr>
<tr class="separator:ad875611beaa8c3103ee742338fd157ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a399f833cff18b0113d3797764c48075a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#a399f833cff18b0113d3797764c48075a">allocate</a> ()</td></tr>
<tr class="memdesc:a399f833cff18b0113d3797764c48075a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reserve memory before storing any matrix entries.  <a href="a00898.html#a399f833cff18b0113d3797764c48075a">More...</a><br /></td></tr>
<tr class="separator:a399f833cff18b0113d3797764c48075a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f438264d43299fc3285e038e31f849a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#a0f438264d43299fc3285e038e31f849a">transposeIfNeeded</a> ()</td></tr>
<tr class="memdesc:a0f438264d43299fc3285e038e31f849a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switch last two dimensions (for transposed transforms)  <a href="a00898.html#a0f438264d43299fc3285e038e31f849a">More...</a><br /></td></tr>
<tr class="separator:a0f438264d43299fc3285e038e31f849a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adda1ef1288986468d34aa1d377d5bdcc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#adda1ef1288986468d34aa1d377d5bdcc">forwardTransform</a> ()</td></tr>
<tr class="memdesc:adda1ef1288986468d34aa1d377d5bdcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transform into Fourier (i.e., frequency) space.  <a href="a00898.html#adda1ef1288986468d34aa1d377d5bdcc">More...</a><br /></td></tr>
<tr class="separator:adda1ef1288986468d34aa1d377d5bdcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a610634e940d15cf5ed8ae6ade405710f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#a610634e940d15cf5ed8ae6ade405710f">backwardTransform</a> ()</td></tr>
<tr class="memdesc:a610634e940d15cf5ed8ae6ade405710f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transform from Fourier (i.e., frequency) space.  <a href="a00898.html#a610634e940d15cf5ed8ae6ade405710f">More...</a><br /></td></tr>
<tr class="separator:a610634e940d15cf5ed8ae6ade405710f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad892633886001178037f49fcc2e0c42c"><td class="memItemLeft" align="right" valign="top">RF&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#ad892633886001178037f49fcc2e0c42c">eval</a> (Index index) const</td></tr>
<tr class="memdesc:ad892633886001178037f49fcc2e0c42c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate matrix entry (in virtual, i.e., logical indices)  <a href="a00898.html#ad892633886001178037f49fcc2e0c42c">More...</a><br /></td></tr>
<tr class="separator:ad892633886001178037f49fcc2e0c42c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78206c5a35e316e0fa8ced37ea984b04"><td class="memItemLeft" align="right" valign="top">RF&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#a78206c5a35e316e0fa8ced37ea984b04">eval</a> (Indices indices) const</td></tr>
<tr class="memdesc:a78206c5a35e316e0fa8ced37ea984b04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate matrix entry (in virtual, i.e., logical indices)  <a href="a00898.html#a78206c5a35e316e0fa8ced37ea984b04">More...</a><br /></td></tr>
<tr class="separator:a78206c5a35e316e0fa8ced37ea984b04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8afb6a012854ec9c28af39c9026aac08"><td class="memItemLeft" align="right" valign="top">RF&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#a8afb6a012854ec9c28af39c9026aac08">get</a> (Index index) const</td></tr>
<tr class="memdesc:a8afb6a012854ec9c28af39c9026aac08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get matrix entry (using the actual index)  <a href="a00898.html#a8afb6a012854ec9c28af39c9026aac08">More...</a><br /></td></tr>
<tr class="separator:a8afb6a012854ec9c28af39c9026aac08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cf45d5b19c4e098439d5896eb5e461f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#a1cf45d5b19c4e098439d5896eb5e461f">set</a> (Index index, RF value)</td></tr>
<tr class="memdesc:a1cf45d5b19c4e098439d5896eb5e461f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set matrix entry (using the actual index)  <a href="a00898.html#a1cf45d5b19c4e098439d5896eb5e461f">More...</a><br /></td></tr>
<tr class="separator:a1cf45d5b19c4e098439d5896eb5e461f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7ceb9a9b8dc6f0e1633d43d68f61acd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00898.html#ad7ceb9a9b8dc6f0e1633d43d68f61acd">finalize</a> ()</td></tr>
<tr class="memdesc:ad7ceb9a9b8dc6f0e1633d43d68f61acd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dummy function, nothing to do after Fourier transform.  <a href="a00898.html#ad7ceb9a9b8dc6f0e1633d43d68f61acd">More...</a><br /></td></tr>
<tr class="separator:ad7ceb9a9b8dc6f0e1633d43d68f61acd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename Traits&gt;<br />
class parafields::DFTMatrixBackend&lt; Traits &gt;</h3>

<p><a class="el" href="a01006.html" title="Covariance matrix for stationary Gaussian random fields.">Matrix</a> backend that uses discrete Fourier transform (DFT) </p>
<p>This matrix backend implements the classical circulant embedding method: the circulant extended covariance matrix is represented as a scalar field on the extended domain, representing either the first row / column of the matrix (on the original domain) or the diagonal of its Fourier transform (in the frequency domain). The backend stores one complex number per cell in the extended domain, and uses the general discrete Fourier transform for its operations.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Traits</td><td>traits class with data types and definitions </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae2058da1584ccbf3eddefd878d77b62a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2058da1584ccbf3eddefd878d77b62a">&#9670;&nbsp;</a></span>DFTMatrixBackend()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::<a class="el" href="a00898.html">DFTMatrixBackend</a> </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; Traits &gt; &amp;&#160;</td>
          <td class="paramname"><em>traits_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>Imports <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> wisdom if configured to do so.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">traits_</td><td>traits object with parameters and communication </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a554d2e5fa1de5d77331cb39e0f00e783"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a554d2e5fa1de5d77331cb39e0f00e783">&#9670;&nbsp;</a></span>~DFTMatrixBackend()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::~<a class="el" href="a00898.html">DFTMatrixBackend</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>
<p>Cleans up allocated arrays and <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> plans. Exports <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> wisdom if configured to do so. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a399f833cff18b0113d3797764c48075a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a399f833cff18b0113d3797764c48075a">&#9670;&nbsp;</a></span>allocate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::allocate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reserve memory before storing any matrix entries. </p>
<p>Explicitly request the matrix backend to reserve storage for the multidimensional array. This ensures that the backend doesn't waste memory when it won't be used. </p>

</div>
</div>
<a id="a610634e940d15cf5ed8ae6ade405710f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a610634e940d15cf5ed8ae6ade405710f">&#9670;&nbsp;</a></span>backwardTransform()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::backwardTransform </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transform from Fourier (i.e., frequency) space. </p>
<p>Perform a backward Fourier transform, mapping from the frequency domain back to the original domain. Uses a single <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> DFT transform. </p>

</div>
</div>
<a id="ad892633886001178037f49fcc2e0c42c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad892633886001178037f49fcc2e0c42c">&#9670;&nbsp;</a></span>eval() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">RF <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::eval </td>
          <td>(</td>
          <td class="paramtype">Index&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate matrix entry (in virtual, i.e., logical indices) </p>
<p>This function returns the matrix entry associated with the given local index (i.e., index for the local part of the array for the extended domain). This backend stores each entry explicitly, and therefore this is just a direct array access.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>flat index for the local array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value associated with index </dd></dl>

</div>
</div>
<a id="a78206c5a35e316e0fa8ced37ea984b04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78206c5a35e316e0fa8ced37ea984b04">&#9670;&nbsp;</a></span>eval() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">RF <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::eval </td>
          <td>(</td>
          <td class="paramtype">Indices&#160;</td>
          <td class="paramname"><em>indices</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate matrix entry (in virtual, i.e., logical indices) </p>
<p>This function returns the matrix entry associated with the given local indices (i.e., tuple of indices for the local part of the array for the extended domain, taking possible offsets into account). This backend stores each entry explicitly, and therefore this is just a direct array access.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">indices</td><td>tuple of local indices</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value associated with indices </dd></dl>

</div>
</div>
<a id="ad7ceb9a9b8dc6f0e1633d43d68f61acd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7ceb9a9b8dc6f0e1633d43d68f61acd">&#9670;&nbsp;</a></span>finalize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::finalize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dummy function, nothing to do after Fourier transform. </p>
<p>This function transforms the stored data in some way in the case of other backends (saving memory, or enabling use in parallel field generation), which makes it impossible to apply any transforms after this method has been called. For the given backend, this method does nothing, and transforms can still be used after it has been called. </p>

</div>
</div>
<a id="adda1ef1288986468d34aa1d377d5bdcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adda1ef1288986468d34aa1d377d5bdcc">&#9670;&nbsp;</a></span>forwardTransform()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::forwardTransform </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transform into Fourier (i.e., frequency) space. </p>
<p>Perform a forward Fourier transform, mapping from the original domain to the frequency domain. Uses a single <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> DFT transform. </p>

</div>
</div>
<a id="a8afb6a012854ec9c28af39c9026aac08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8afb6a012854ec9c28af39c9026aac08">&#9670;&nbsp;</a></span>get()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">RF <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::get </td>
          <td>(</td>
          <td class="paramtype">Index&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get matrix entry (using the actual index) </p>
<p>This function returns the entry of the array associated with the given index. This backend stores each matrix value for the extended domain, so this is the same as the eval method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>flat index for the local array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value associated with index</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="a00898.html#ad892633886001178037f49fcc2e0c42c" title="Evaluate matrix entry (in virtual, i.e., logical indices)">eval</a> </dd></dl>

</div>
</div>
<a id="ad875611beaa8c3103ee742338fd157ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad875611beaa8c3103ee742338fd157ef">&#9670;&nbsp;</a></span>localEvalMatrixCells()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const Indices&amp; <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::localEvalMatrixCells </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of logical entries per dim on this processor. </p>
<p>This is the number of entries that the local array represents. For the given backend, this is identical with localMatrixCells, but it can differ for other backends, which make use of redundancy in the matrix array.</p>
<dl class="section return"><dt>Returns</dt><dd>tuple of local cells per dimension </dd></dl>

</div>
</div>
<a id="aa107d13262d2fee4989b211e62b0da9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa107d13262d2fee4989b211e62b0da9d">&#9670;&nbsp;</a></span>localMatrixCells()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const Indices&amp; <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::localMatrixCells </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of entries per dim on this processor. </p>
<p>This is the number of cells per dimension of the extended domain, or the number of cells per dimension for the local part of the extended domain in the case of parallel data distribution.</p>
<dl class="section return"><dt>Returns</dt><dd>tuple of local cells per dimension </dd></dl>

</div>
</div>
<a id="aa95bb896931308831dbe07332654ed9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa95bb896931308831dbe07332654ed9c">&#9670;&nbsp;</a></span>localMatrixOffset()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const Indices&amp; <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::localMatrixOffset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Offset between local indices and global indices per dim. </p>
<p>This is the tuple of offsets, one per dimension, between the start of the local array and the start of the global array spanning all processors.</p>
<dl class="section return"><dt>Returns</dt><dd>tuple of offsets </dd></dl>

</div>
</div>
<a id="aa0320529369704c414123291cd643d66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0320529369704c414123291cd643d66">&#9670;&nbsp;</a></span>localMatrixSize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Index <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::localMatrixSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of matrix entries stored on this processor. </p>
<p>This is the size of the extended domain, or its local subset in the case of parallel data distribution.</p>
<dl class="section return"><dt>Returns</dt><dd>number of local degrees of freedom </dd></dl>

</div>
</div>
<a id="a1cf45d5b19c4e098439d5896eb5e461f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cf45d5b19c4e098439d5896eb5e461f">&#9670;&nbsp;</a></span>set()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::set </td>
          <td>(</td>
          <td class="paramtype">Index&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">RF&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set matrix entry (using the actual index) </p>
<p>This function sets the entry of the array associated with the given index. The argument is used for the real part, and the imaginary part is set zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>flat index for the local array </td></tr>
    <tr><td class="paramname">value</td><td>value that should be associated with the index </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0f438264d43299fc3285e038e31f849a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f438264d43299fc3285e038e31f849a">&#9670;&nbsp;</a></span>transposeIfNeeded()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::transposeIfNeeded </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Switch last two dimensions (for transposed transforms) </p>
<p>This function switches the last two dimensions, which is needed for <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> transposed transforms, where the Fourier transform of the matrix is stored transposed to eliminate the final transpose step. Is automatically called by the transform methods, but may be needed when a newly created backend should be constructed directly in frequency space. </p>

</div>
</div>
<a id="a8f867215ac7f71c926568e5ac6a64595"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f867215ac7f71c926568e5ac6a64595">&#9670;&nbsp;</a></span>update()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::update </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="acf9fbdba9b2dd2f206dd83c53834d968"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf9fbdba9b2dd2f206dd83c53834d968">&#9670;&nbsp;</a></span>valid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="a00898.html">parafields::DFTMatrixBackend</a>&lt; Traits &gt;::valid </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check whether matrix has already been created. </p>
<dl class="section return"><dt>Returns</dt><dd>true if the matrix data is present, else false </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="a00014_source.html">dftmatrixbackend.hh</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
