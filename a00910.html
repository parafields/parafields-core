<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>parafields-core: parafields::R2CFieldBackend&lt; Traits &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">parafields-core
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="a00066.html">parafields</a></li><li class="navelem"><a class="el" href="a00910.html">R2CFieldBackend</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="a00907.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">parafields::R2CFieldBackend&lt; Traits &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Field backend that uses real-input discrete Fourier transform (R2C)  
 <a href="a00910.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="a00023_source.html">r2cfieldbackend.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a96db9bfe3a466ed92fe8239c85b3b6c1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00910.html#a96db9bfe3a466ed92fe8239c85b3b6c1">R2CFieldBackend</a> (const std::shared_ptr&lt; Traits &gt; &amp;traits_)</td></tr>
<tr class="memdesc:a96db9bfe3a466ed92fe8239c85b3b6c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="a00910.html#a96db9bfe3a466ed92fe8239c85b3b6c1">More...</a><br /></td></tr>
<tr class="separator:a96db9bfe3a466ed92fe8239c85b3b6c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e1a03a2a9419a0c5026cc5d6b01499e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00910.html#a2e1a03a2a9419a0c5026cc5d6b01499e">~R2CFieldBackend</a> ()</td></tr>
<tr class="memdesc:a2e1a03a2a9419a0c5026cc5d6b01499e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="a00910.html#a2e1a03a2a9419a0c5026cc5d6b01499e">More...</a><br /></td></tr>
<tr class="separator:a2e1a03a2a9419a0c5026cc5d6b01499e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af49279cf6af32ce1e37a151d26dc12db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00910.html#af49279cf6af32ce1e37a151d26dc12db">update</a> ()</td></tr>
<tr class="separator:af49279cf6af32ce1e37a151d26dc12db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbcee6d23d71392bb5c6292f199fed55"><td class="memItemLeft" align="right" valign="top">Index&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00910.html#abbcee6d23d71392bb5c6292f199fed55">localFieldSize</a> () const</td></tr>
<tr class="memdesc:abbcee6d23d71392bb5c6292f199fed55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of extended field entries stored on this processor.  <a href="a00910.html#abbcee6d23d71392bb5c6292f199fed55">More...</a><br /></td></tr>
<tr class="separator:abbcee6d23d71392bb5c6292f199fed55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79659db49c1e665dc89b5dbbeb5dbb13"><td class="memItemLeft" align="right" valign="top">const Indices &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00910.html#a79659db49c1e665dc89b5dbbeb5dbb13">localFieldCells</a> () const</td></tr>
<tr class="memdesc:a79659db49c1e665dc89b5dbbeb5dbb13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of entries per dim on this processor.  <a href="a00910.html#a79659db49c1e665dc89b5dbbeb5dbb13">More...</a><br /></td></tr>
<tr class="separator:a79659db49c1e665dc89b5dbbeb5dbb13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ae16567d7fc43176a0c4adb9b2ecb58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00910.html#a8ae16567d7fc43176a0c4adb9b2ecb58">allocate</a> ()</td></tr>
<tr class="memdesc:a8ae16567d7fc43176a0c4adb9b2ecb58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reserve memory before storing any field entries.  <a href="a00910.html#a8ae16567d7fc43176a0c4adb9b2ecb58">More...</a><br /></td></tr>
<tr class="separator:a8ae16567d7fc43176a0c4adb9b2ecb58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae856ab0c4eb244ef1f135b22dd1f88ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00910.html#ae856ab0c4eb244ef1f135b22dd1f88ba">transposeIfNeeded</a> ()</td></tr>
<tr class="memdesc:ae856ab0c4eb244ef1f135b22dd1f88ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switch last two dimensions (for transposed transforms)  <a href="a00910.html#ae856ab0c4eb244ef1f135b22dd1f88ba">More...</a><br /></td></tr>
<tr class="separator:ae856ab0c4eb244ef1f135b22dd1f88ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c85e49fdb5568b5fef8a8591390edf5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00910.html#a5c85e49fdb5568b5fef8a8591390edf5">forwardTransform</a> ()</td></tr>
<tr class="memdesc:a5c85e49fdb5568b5fef8a8591390edf5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transform into Fourier (i.e., frequency) space.  <a href="a00910.html#a5c85e49fdb5568b5fef8a8591390edf5">More...</a><br /></td></tr>
<tr class="separator:a5c85e49fdb5568b5fef8a8591390edf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf6c5167545b5dea97f0595afa76b712"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00910.html#acf6c5167545b5dea97f0595afa76b712">backwardTransform</a> ()</td></tr>
<tr class="memdesc:acf6c5167545b5dea97f0595afa76b712"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transform from Fourier (i.e., frequency) space.  <a href="a00910.html#acf6c5167545b5dea97f0595afa76b712">More...</a><br /></td></tr>
<tr class="separator:acf6c5167545b5dea97f0595afa76b712"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa98b670d0723d18f22bb5b75a6c9408c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00910.html#aa98b670d0723d18f22bb5b75a6c9408c">hasSpareField</a> () const</td></tr>
<tr class="memdesc:aa98b670d0723d18f22bb5b75a6c9408c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether this kind of backend produces two fields at once.  <a href="a00910.html#aa98b670d0723d18f22bb5b75a6c9408c">More...</a><br /></td></tr>
<tr class="separator:aa98b670d0723d18f22bb5b75a6c9408c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff21467ddeb93b1860f6998632928797"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00910.html#aff21467ddeb93b1860f6998632928797">set</a> (Index index, RF lambda, RF rand1, RF rand2)</td></tr>
<tr class="memdesc:aff21467ddeb93b1860f6998632928797"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set entry based on pair of random numbers.  <a href="a00910.html#aff21467ddeb93b1860f6998632928797">More...</a><br /></td></tr>
<tr class="separator:aff21467ddeb93b1860f6998632928797"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2726cbbef151a69d8e4e13641d73eb73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00910.html#a2726cbbef151a69d8e4e13641d73eb73">mult</a> (Index index, RF lambda)</td></tr>
<tr class="memdesc:a2726cbbef151a69d8e4e13641d73eb73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiply entry with given number.  <a href="a00910.html#a2726cbbef151a69d8e4e13641d73eb73">More...</a><br /></td></tr>
<tr class="separator:a2726cbbef151a69d8e4e13641d73eb73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ed5acf036626d3e84cc7e43f80e6198"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00910.html#a2ed5acf036626d3e84cc7e43f80e6198">fieldToExtendedField</a> (std::vector&lt; RF &gt; &amp;field)</td></tr>
<tr class="memdesc:a2ed5acf036626d3e84cc7e43f80e6198"><td class="mdescLeft">&#160;</td><td class="mdescRight">Embed a random field in the extended domain.  <a href="a00910.html#a2ed5acf036626d3e84cc7e43f80e6198">More...</a><br /></td></tr>
<tr class="separator:a2ed5acf036626d3e84cc7e43f80e6198"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcd1b0cc2219e8b50495478c902ea8df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00910.html#adcd1b0cc2219e8b50495478c902ea8df">extendedFieldToField</a> (std::vector&lt; RF &gt; &amp;field, unsigned int component=0) const</td></tr>
<tr class="memdesc:adcd1b0cc2219e8b50495478c902ea8df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restrict an extended random field to the original domain.  <a href="a00910.html#adcd1b0cc2219e8b50495478c902ea8df">More...</a><br /></td></tr>
<tr class="separator:adcd1b0cc2219e8b50495478c902ea8df"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename Traits&gt;<br />
class parafields::R2CFieldBackend&lt; Traits &gt;</h3>

<p>Field backend that uses real-input discrete Fourier transform (R2C) </p>
<p>This field backend is an implementation of the extended field that generates one sample at a time and saves memory in the process. The classical circulant embedding method transforms complex-valued noise into two random fields. This backend creates the Hermitian part of the noise instead, which is the part that ends up as the real part of the generated field. The anti-Hermitian part, which would end up as the imaginary part, is never generated, and so half the memory can be saved at little extra cost in runtime. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a96db9bfe3a466ed92fe8239c85b3b6c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96db9bfe3a466ed92fe8239c85b3b6c1">&#9670;&nbsp;</a></span>R2CFieldBackend()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00910.html">parafields::R2CFieldBackend</a>&lt; Traits &gt;::<a class="el" href="a00910.html">R2CFieldBackend</a> </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; Traits &gt; &amp;&#160;</td>
          <td class="paramname"><em>traits_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>Imports <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> wisdom if configured to do so.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">traits_</td><td>traits object with parameters and communication </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2e1a03a2a9419a0c5026cc5d6b01499e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e1a03a2a9419a0c5026cc5d6b01499e">&#9670;&nbsp;</a></span>~R2CFieldBackend()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00910.html">parafields::R2CFieldBackend</a>&lt; Traits &gt;::~<a class="el" href="a00910.html">R2CFieldBackend</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>
<p>Cleans up allocated arrays and <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> plans. Exports <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> wisdom if configured to do so. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8ae16567d7fc43176a0c4adb9b2ecb58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ae16567d7fc43176a0c4adb9b2ecb58">&#9670;&nbsp;</a></span>allocate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00910.html">parafields::R2CFieldBackend</a>&lt; Traits &gt;::allocate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reserve memory before storing any field entries. </p>
<p>Explicitly request the field backend to reserve storage for the multidimensional array. This ensures that the backend doesn't waste memory when it won't be used. </p>

</div>
</div>
<a id="acf6c5167545b5dea97f0595afa76b712"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf6c5167545b5dea97f0595afa76b712">&#9670;&nbsp;</a></span>backwardTransform()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00910.html">parafields::R2CFieldBackend</a>&lt; Traits &gt;::backwardTransform </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transform from Fourier (i.e., frequency) space. </p>
<p>Perform a backward Fourier transform, mapping from the frequency domain back to the original domain. Uses a single <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> complex-to-real DFT transform: the input is a multidimensional Hermitian array of complex numbers, with half the data not stored because of redundancy, and the output is an array of real numbers. </p>

</div>
</div>
<a id="adcd1b0cc2219e8b50495478c902ea8df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcd1b0cc2219e8b50495478c902ea8df">&#9670;&nbsp;</a></span>extendedFieldToField()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00910.html">parafields::R2CFieldBackend</a>&lt; Traits &gt;::extendedFieldToField </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; RF &gt; &amp;&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>component</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Restrict an extended random field to the original domain. </p>
<p>This function restricts an extended random field and cuts out the part that lies on the original domain. The optional argument can be used to select between the two fields that are stored in the real and imaginary part of the extended random field.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">field</td><td>random field to fill with restriction </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">component</td><td>dummy variable, backend produces single field </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2ed5acf036626d3e84cc7e43f80e6198"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ed5acf036626d3e84cc7e43f80e6198">&#9670;&nbsp;</a></span>fieldToExtendedField()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00910.html">parafields::R2CFieldBackend</a>&lt; Traits &gt;::fieldToExtendedField </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; RF &gt; &amp;&#160;</td>
          <td class="paramname"><em>field</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Embed a random field in the extended domain. </p>
<p>This function maps a random field onto the extended domain, filling any cells that are not part of the original domain with zero values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field</td><td>random field to embed in larger domain </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5c85e49fdb5568b5fef8a8591390edf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c85e49fdb5568b5fef8a8591390edf5">&#9670;&nbsp;</a></span>forwardTransform()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00910.html">parafields::R2CFieldBackend</a>&lt; Traits &gt;::forwardTransform </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transform into Fourier (i.e., frequency) space. </p>
<p>Perform a forward Fourier transform, mapping from the original domain to the frequency domain. Uses a single <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> real-to-complex DFT transform: the input is a multidimensional array of real numbers, the output a Hermitian array of complex numbers, with half the data not stored because of redundancy. </p>

</div>
</div>
<a id="aa98b670d0723d18f22bb5b75a6c9408c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa98b670d0723d18f22bb5b75a6c9408c">&#9670;&nbsp;</a></span>hasSpareField()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="a00910.html">parafields::R2CFieldBackend</a>&lt; Traits &gt;::hasSpareField </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether this kind of backend produces two fields at once. </p>
<p>This backend produces a single real-valued field.</p>
<dl class="section return"><dt>Returns</dt><dd>false </dd></dl>

</div>
</div>
<a id="a79659db49c1e665dc89b5dbbeb5dbb13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79659db49c1e665dc89b5dbbeb5dbb13">&#9670;&nbsp;</a></span>localFieldCells()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const Indices&amp; <a class="el" href="a00910.html">parafields::R2CFieldBackend</a>&lt; Traits &gt;::localFieldCells </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of entries per dim on this processor. </p>
<p>This is the number of cells per dimension of the extended domain, or the number of cells per dimension for the local part of the extended domain in the case of parallel data distribution. This is in the frequency domain, so one of the dimensions is cut in half to account for the redundancy due to the Hermitian property.</p>
<dl class="section return"><dt>Returns</dt><dd>tuple of local cells per dimension </dd></dl>

</div>
</div>
<a id="abbcee6d23d71392bb5c6292f199fed55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbcee6d23d71392bb5c6292f199fed55">&#9670;&nbsp;</a></span>localFieldSize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Index <a class="el" href="a00910.html">parafields::R2CFieldBackend</a>&lt; Traits &gt;::localFieldSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of extended field entries stored on this processor. </p>
<p>This is the number of extended field entries that are stored, in the frequency domain. The backend produces a single real-valued random field from Hermitian complex noise, which means that half the entries of the noise are redundant and are not actually stored.</p>
<dl class="section return"><dt>Returns</dt><dd>number of local degrees of freedom </dd></dl>

</div>
</div>
<a id="a2726cbbef151a69d8e4e13641d73eb73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2726cbbef151a69d8e4e13641d73eb73">&#9670;&nbsp;</a></span>mult()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00910.html">parafields::R2CFieldBackend</a>&lt; Traits &gt;::mult </td>
          <td>(</td>
          <td class="paramtype">Index&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">RF&#160;</td>
          <td class="paramname"><em>lambda</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Multiply entry with given number. </p>
<p>This function multiplies a complex entry of the array with a scalar. This is used when a random field should be multiplied with the covariance matrix, or its inverse, etc.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>index of extended field cell to scale </td></tr>
    <tr><td class="paramname">lambda</td><td>scalar factor </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aff21467ddeb93b1860f6998632928797"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff21467ddeb93b1860f6998632928797">&#9670;&nbsp;</a></span>set()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00910.html">parafields::R2CFieldBackend</a>&lt; Traits &gt;::set </td>
          <td>(</td>
          <td class="paramtype">Index&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">RF&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">RF&#160;</td>
          <td class="paramname"><em>rand1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">RF&#160;</td>
          <td class="paramname"><em>rand2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set entry based on pair of random numbers. </p>
<p>This function takes two normally distributed random numbers and stores them in the backend, after multiplying them with a scalar value, which is the square root of one of the eigenvalues of the extended covariance matrix. The two values are interpreted as the Hermitian part of the noise of the original circulant embedding method, and therefore have to be scaled with the inverse square root of two. Together with the anti-Hermitian half they would then generate the original noise. Cells that lie at the beginning or exactly in the middle of the array in each dimension need special treatment, since they are their own mirror image when reflecting at the origin.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>index of extended field cell to fill </td></tr>
    <tr><td class="paramname">lambda</td><td>square root of covariance matrix eigenvalue </td></tr>
    <tr><td class="paramname">rand1</td><td>normally distributed random number </td></tr>
    <tr><td class="paramname">rand2</td><td>second normally distributed random number </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae856ab0c4eb244ef1f135b22dd1f88ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae856ab0c4eb244ef1f135b22dd1f88ba">&#9670;&nbsp;</a></span>transposeIfNeeded()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00910.html">parafields::R2CFieldBackend</a>&lt; Traits &gt;::transposeIfNeeded </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Switch last two dimensions (for transposed transforms) </p>
<p>This function switches the last two dimensions, which is needed for <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> transposed transforms, where the Fourier transform of the matrix is stored transposed to eliminate the final transpose step. Is automatically called by the transform methods, but may be needed when a newly created backend should be constructed directly in frequency space. </p>

</div>
</div>
<a id="af49279cf6af32ce1e37a151d26dc12db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af49279cf6af32ce1e37a151d26dc12db">&#9670;&nbsp;</a></span>update()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00910.html">parafields::R2CFieldBackend</a>&lt; Traits &gt;::update </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="a00023_source.html">r2cfieldbackend.hh</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
