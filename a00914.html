<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>parafields-core: parafields::R2CMatrixBackend&lt; Traits &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">parafields-core
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="a00066.html">parafields</a></li><li class="navelem"><a class="el" href="a00914.html">R2CMatrixBackend</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="a00911.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">parafields::R2CMatrixBackend&lt; Traits &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="a01002.html" title="Covariance matrix for stationary Gaussian random fields.">Matrix</a> backend that uses real-input discrete Fourier transform (R2C)  
 <a href="a00914.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="a00026_source.html">r2cmatrixbackend.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a83012343a6ffffefbcfbebae44c05855"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#a83012343a6ffffefbcfbebae44c05855">R2CMatrixBackend</a> (const std::shared_ptr&lt; Traits &gt; &amp;traits_)</td></tr>
<tr class="memdesc:a83012343a6ffffefbcfbebae44c05855"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="a00914.html#a83012343a6ffffefbcfbebae44c05855">More...</a><br /></td></tr>
<tr class="separator:a83012343a6ffffefbcfbebae44c05855"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af960636a941a916384d68f4f655c78d6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#af960636a941a916384d68f4f655c78d6">~R2CMatrixBackend</a> ()</td></tr>
<tr class="memdesc:af960636a941a916384d68f4f655c78d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="a00914.html#af960636a941a916384d68f4f655c78d6">More...</a><br /></td></tr>
<tr class="separator:af960636a941a916384d68f4f655c78d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12ab172cecac4860fff4267ba4f7e3c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#a12ab172cecac4860fff4267ba4f7e3c7">update</a> ()</td></tr>
<tr class="separator:a12ab172cecac4860fff4267ba4f7e3c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a705079851d4d4f0fbc2fe4d21125888e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#a705079851d4d4f0fbc2fe4d21125888e">valid</a> () const</td></tr>
<tr class="memdesc:a705079851d4d4f0fbc2fe4d21125888e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether matrix has already been created.  <a href="a00914.html#a705079851d4d4f0fbc2fe4d21125888e">More...</a><br /></td></tr>
<tr class="separator:a705079851d4d4f0fbc2fe4d21125888e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b81bb80b031537adbf9c31a45611fc4"><td class="memItemLeft" align="right" valign="top">Index&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#a7b81bb80b031537adbf9c31a45611fc4">localMatrixSize</a> () const</td></tr>
<tr class="memdesc:a7b81bb80b031537adbf9c31a45611fc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of matrix entries stored on this processor.  <a href="a00914.html#a7b81bb80b031537adbf9c31a45611fc4">More...</a><br /></td></tr>
<tr class="separator:a7b81bb80b031537adbf9c31a45611fc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79a66532b26a205fc91d7e6bf8ef9cad"><td class="memItemLeft" align="right" valign="top">const Indices &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#a79a66532b26a205fc91d7e6bf8ef9cad">localMatrixCells</a> () const</td></tr>
<tr class="memdesc:a79a66532b26a205fc91d7e6bf8ef9cad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of entries per dim on this processor.  <a href="a00914.html#a79a66532b26a205fc91d7e6bf8ef9cad">More...</a><br /></td></tr>
<tr class="separator:a79a66532b26a205fc91d7e6bf8ef9cad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f2ad38b8ae8a4652d9fdcfd485b8d75"><td class="memItemLeft" align="right" valign="top">const Indices &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#a4f2ad38b8ae8a4652d9fdcfd485b8d75">localMatrixOffset</a> () const</td></tr>
<tr class="memdesc:a4f2ad38b8ae8a4652d9fdcfd485b8d75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Offset between local indices and global indices per dim.  <a href="a00914.html#a4f2ad38b8ae8a4652d9fdcfd485b8d75">More...</a><br /></td></tr>
<tr class="separator:a4f2ad38b8ae8a4652d9fdcfd485b8d75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0587f12f0a983444de061731f2d1781"><td class="memItemLeft" align="right" valign="top">const Indices &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#ad0587f12f0a983444de061731f2d1781">localEvalMatrixCells</a> () const</td></tr>
<tr class="memdesc:ad0587f12f0a983444de061731f2d1781"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of logical entries per dim on this processor.  <a href="a00914.html#ad0587f12f0a983444de061731f2d1781">More...</a><br /></td></tr>
<tr class="separator:ad0587f12f0a983444de061731f2d1781"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1124221a99204063ba60d1d22ec7e08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#ad1124221a99204063ba60d1d22ec7e08">allocate</a> ()</td></tr>
<tr class="memdesc:ad1124221a99204063ba60d1d22ec7e08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reserve memory before storing any matrix entries.  <a href="a00914.html#ad1124221a99204063ba60d1d22ec7e08">More...</a><br /></td></tr>
<tr class="separator:ad1124221a99204063ba60d1d22ec7e08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3f971745874c71ccccf8d756a33699a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#af3f971745874c71ccccf8d756a33699a">transposeIfNeeded</a> ()</td></tr>
<tr class="memdesc:af3f971745874c71ccccf8d756a33699a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switch last two dimensions (for transposed transforms)  <a href="a00914.html#af3f971745874c71ccccf8d756a33699a">More...</a><br /></td></tr>
<tr class="separator:af3f971745874c71ccccf8d756a33699a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbf2781aa6386c035470ef10b18188c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#abbf2781aa6386c035470ef10b18188c9">forwardTransform</a> ()</td></tr>
<tr class="memdesc:abbf2781aa6386c035470ef10b18188c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transform into Fourier (i.e., frequency) space.  <a href="a00914.html#abbf2781aa6386c035470ef10b18188c9">More...</a><br /></td></tr>
<tr class="separator:abbf2781aa6386c035470ef10b18188c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b9cb728ed261cd155e3f0beafc5902d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#a3b9cb728ed261cd155e3f0beafc5902d">backwardTransform</a> ()</td></tr>
<tr class="memdesc:a3b9cb728ed261cd155e3f0beafc5902d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transform from Fourier (i.e., frequency) space.  <a href="a00914.html#a3b9cb728ed261cd155e3f0beafc5902d">More...</a><br /></td></tr>
<tr class="separator:a3b9cb728ed261cd155e3f0beafc5902d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a211c786b9207f63a2c821b3c6a90aed4"><td class="memItemLeft" align="right" valign="top">RF&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#a211c786b9207f63a2c821b3c6a90aed4">eval</a> (Index index) const</td></tr>
<tr class="memdesc:a211c786b9207f63a2c821b3c6a90aed4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate matrix entry (in virtual, i.e., logical indices)  <a href="a00914.html#a211c786b9207f63a2c821b3c6a90aed4">More...</a><br /></td></tr>
<tr class="separator:a211c786b9207f63a2c821b3c6a90aed4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6685a8aff620fc24c8f81309aa210b65"><td class="memItemLeft" align="right" valign="top">RF&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#a6685a8aff620fc24c8f81309aa210b65">eval</a> (Indices indices) const</td></tr>
<tr class="memdesc:a6685a8aff620fc24c8f81309aa210b65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate matrix entry (in virtual, i.e., logical indices)  <a href="a00914.html#a6685a8aff620fc24c8f81309aa210b65">More...</a><br /></td></tr>
<tr class="separator:a6685a8aff620fc24c8f81309aa210b65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa20eccbe7f5fd2ec116aad3f50e9d09"><td class="memItemLeft" align="right" valign="top">RF&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#aaa20eccbe7f5fd2ec116aad3f50e9d09">get</a> (Index index) const</td></tr>
<tr class="memdesc:aaa20eccbe7f5fd2ec116aad3f50e9d09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get matrix entry (using the actual index)  <a href="a00914.html#aaa20eccbe7f5fd2ec116aad3f50e9d09">More...</a><br /></td></tr>
<tr class="separator:aaa20eccbe7f5fd2ec116aad3f50e9d09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1321ab8be308f05f9f0df77930132905"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#a1321ab8be308f05f9f0df77930132905">set</a> (Index index, RF value)</td></tr>
<tr class="memdesc:a1321ab8be308f05f9f0df77930132905"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set matrix entry (using the actual index)  <a href="a00914.html#a1321ab8be308f05f9f0df77930132905">More...</a><br /></td></tr>
<tr class="separator:a1321ab8be308f05f9f0df77930132905"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adde0f82227e205cc521191645ecbd267"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00914.html#adde0f82227e205cc521191645ecbd267">finalize</a> ()</td></tr>
<tr class="memdesc:adde0f82227e205cc521191645ecbd267"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove zero imaginary part.  <a href="a00914.html#adde0f82227e205cc521191645ecbd267">More...</a><br /></td></tr>
<tr class="separator:adde0f82227e205cc521191645ecbd267"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename Traits&gt;<br />
class parafields::R2CMatrixBackend&lt; Traits &gt;</h3>

<p><a class="el" href="a01002.html" title="Covariance matrix for stationary Gaussian random fields.">Matrix</a> backend that uses real-input discrete Fourier transform (R2C) </p>
<p>This matrix backend is an implementation of the circulant embedding method that makes use of data redundancy to save a significant amount of memory and time. By construction, the covariance function is an even real function, which means that its Fourier transform is also even and real. As a consequence, both the required memory and the number of instructions needed for the transform can be reduced by roughly a factor of four. However, <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> doesn't offer general real even transforms for higher dimensions, only tensor products of onedimensional transforms. Therefore, a real-to-complex DFT is employed to create an Hermitian complex transformed covariance matrix, and then the zero imaginary part is eliminated. This needs more time than a true real-to-real transform would, but the additional memory use can be masked, since the storage for the field backend hasn't been allocated at this point in time.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Traits</td><td>traits class with data types and definitions </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a83012343a6ffffefbcfbebae44c05855"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83012343a6ffffefbcfbebae44c05855">&#9670;&nbsp;</a></span>R2CMatrixBackend()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::<a class="el" href="a00914.html">R2CMatrixBackend</a> </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; Traits &gt; &amp;&#160;</td>
          <td class="paramname"><em>traits_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>Imports <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> wisdom if configured to do so.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">traits_</td><td>traits object with parameters and communication </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af960636a941a916384d68f4f655c78d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af960636a941a916384d68f4f655c78d6">&#9670;&nbsp;</a></span>~R2CMatrixBackend()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::~<a class="el" href="a00914.html">R2CMatrixBackend</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>
<p>Cleans up allocated arrays and <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> plans. Exports <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> wisdom if configured to do so. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ad1124221a99204063ba60d1d22ec7e08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1124221a99204063ba60d1d22ec7e08">&#9670;&nbsp;</a></span>allocate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::allocate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reserve memory before storing any matrix entries. </p>
<p>Explicitly request the matrix backend to reserve storage for the multidimensional array. This ensures that the backend doesn't waste memory when it won't be used. </p>

</div>
</div>
<a id="a3b9cb728ed261cd155e3f0beafc5902d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b9cb728ed261cd155e3f0beafc5902d">&#9670;&nbsp;</a></span>backwardTransform()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::backwardTransform </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transform from Fourier (i.e., frequency) space. </p>
<p>Perform a backward Fourier transform, mapping from the frequency domain back to the original domain. Uses a single <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> complex-to-real DFT transform: the input is a multidimensional Hermitian array of complex numbers, with half the data not stored because of redundancy, and the output is an array of real numbers. </p>

</div>
</div>
<a id="a211c786b9207f63a2c821b3c6a90aed4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a211c786b9207f63a2c821b3c6a90aed4">&#9670;&nbsp;</a></span>eval() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">RF <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::eval </td>
          <td>(</td>
          <td class="paramtype">Index&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate matrix entry (in virtual, i.e., logical indices) </p>
<p>This function returns the matrix entry associated with the given local index (i.e., index for the local part of the array for the extended domain). This is used after transform, so half the entries are missing and have to be reconstructed by accessing the corresponding other index. At this point, the data is purely real, because the finalize method has been called beforehand.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>flat index for the local array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value associated with index </dd></dl>

</div>
</div>
<a id="a6685a8aff620fc24c8f81309aa210b65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6685a8aff620fc24c8f81309aa210b65">&#9670;&nbsp;</a></span>eval() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">RF <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::eval </td>
          <td>(</td>
          <td class="paramtype">Indices&#160;</td>
          <td class="paramname"><em>indices</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate matrix entry (in virtual, i.e., logical indices) </p>
<p>This function returns the matrix entry associated with the given local indices (i.e., tuple of indices for the local part of the array for the extended domain, taking possible offsets into account). This is used after transform, so half the entries are missing and have to be reconstructed by accessing the corresponding other index. The method takes care of this, and remaps indices that would access parts of the array that are not actually present.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">indices</td><td>tuple of local indices</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value associated with indices </dd></dl>

</div>
</div>
<a id="adde0f82227e205cc521191645ecbd267"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adde0f82227e205cc521191645ecbd267">&#9670;&nbsp;</a></span>finalize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::finalize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Remove zero imaginary part. </p>
<p>This function takes the transformed array, which is an Hermitian array of complex numbers that has half the number of indices as the original array, and deletes its imaginary part, since that is zero. After this function has been called, the array will have half the number of entries as the original array before the transform, and the backend can no longer be modified. </p>

</div>
</div>
<a id="abbf2781aa6386c035470ef10b18188c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbf2781aa6386c035470ef10b18188c9">&#9670;&nbsp;</a></span>forwardTransform()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::forwardTransform </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transform into Fourier (i.e., frequency) space. </p>
<p>Perform a forward Fourier transform, mapping from the original domain to the frequency domain. Uses a single <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> real-to-complex DFT transform: the input is a multidimensional array of real numbers, the output a Hermitian array of complex numbers, with half the data not stored because of redundancy. </p>

</div>
</div>
<a id="aaa20eccbe7f5fd2ec116aad3f50e9d09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa20eccbe7f5fd2ec116aad3f50e9d09">&#9670;&nbsp;</a></span>get()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">RF <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::get </td>
          <td>(</td>
          <td class="paramtype">Index&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get matrix entry (using the actual index) </p>
<p>This function returns the entry of the array associated with the given index. It uses the actual index of the untransformed array, and may not be used after the matrix backend has been finalized.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>flat index for the local array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value associated with index</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="a00914.html#a211c786b9207f63a2c821b3c6a90aed4" title="Evaluate matrix entry (in virtual, i.e., logical indices)">eval</a> </dd>
<dd>
<a class="el" href="a00914.html#adde0f82227e205cc521191645ecbd267" title="Remove zero imaginary part.">finalize</a> </dd></dl>

</div>
</div>
<a id="ad0587f12f0a983444de061731f2d1781"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0587f12f0a983444de061731f2d1781">&#9670;&nbsp;</a></span>localEvalMatrixCells()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const Indices&amp; <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::localEvalMatrixCells </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of logical entries per dim on this processor. </p>
<p>This is the number of entries that the local array represents. This is after transformation, so the total number of indices is half that of the original array. The calling code has to take this into account, because only the part that is actually stored can be accessed directly, and the other half has to be reconstructed by mapping to the associated other index.</p>
<dl class="section return"><dt>Returns</dt><dd>tuple of local cells per dimension </dd></dl>

</div>
</div>
<a id="a79a66532b26a205fc91d7e6bf8ef9cad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79a66532b26a205fc91d7e6bf8ef9cad">&#9670;&nbsp;</a></span>localMatrixCells()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const Indices&amp; <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::localMatrixCells </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of entries per dim on this processor. </p>
<p>This is the number of cells per dimension of the extended domain, or the number of cells per dimension for the local part of the extended domain in the case of parallel data distribution.</p>
<dl class="section return"><dt>Returns</dt><dd>tuple of local cells per dimension </dd></dl>

</div>
</div>
<a id="a4f2ad38b8ae8a4652d9fdcfd485b8d75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f2ad38b8ae8a4652d9fdcfd485b8d75">&#9670;&nbsp;</a></span>localMatrixOffset()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const Indices&amp; <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::localMatrixOffset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Offset between local indices and global indices per dim. </p>
<p>This is the tuple of offsets, one per dimension, between the start of the local array and the start of the global array spanning all processors.</p>
<dl class="section return"><dt>Returns</dt><dd>tuple of offsets </dd></dl>

</div>
</div>
<a id="a7b81bb80b031537adbf9c31a45611fc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b81bb80b031537adbf9c31a45611fc4">&#9670;&nbsp;</a></span>localMatrixSize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Index <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::localMatrixSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of matrix entries stored on this processor. </p>
<p>For this backend, the method may return two different values, depending on whether the data has been transformed or not. The untransformed array contains real numbers, and the size of the array is the same as with <a class="el" href="a00898.html" title="Matrix backend that uses discrete Fourier transform (DFT)">DFTMatrixBackend</a>, which is simply the size of the extended domain, or its local subset in the case of parallel data distribution. The transformed array contains complex numbers, i.e., twice the data per index, but has only half as many indices, because half the entries are redundant due to symmetry.</p>
<dl class="section return"><dt>Returns</dt><dd>number of local degrees of freedom </dd></dl>

</div>
</div>
<a id="a1321ab8be308f05f9f0df77930132905"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1321ab8be308f05f9f0df77930132905">&#9670;&nbsp;</a></span>set()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::set </td>
          <td>(</td>
          <td class="paramtype">Index&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">RF&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set matrix entry (using the actual index) </p>
<p>This function sets the entry of the array associated with the given index. It uses the actual index of the untransformed array, and may not be used after the matrix backend has been finalized.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>flat index for the local array </td></tr>
    <tr><td class="paramname">value</td><td>value that should be associated with the index</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="a00914.html#adde0f82227e205cc521191645ecbd267" title="Remove zero imaginary part.">finalize</a> </dd></dl>

</div>
</div>
<a id="af3f971745874c71ccccf8d756a33699a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3f971745874c71ccccf8d756a33699a">&#9670;&nbsp;</a></span>transposeIfNeeded()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::transposeIfNeeded </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Switch last two dimensions (for transposed transforms) </p>
<p>This function switches the last two dimensions, which is needed for <a class="el" href="a00902.html" title="Fallback class for error message when requested FFTW3 library wasn&#39;t found.">FFTW</a> transposed transforms, where the Fourier transform of the matrix is stored transposed to eliminate the final transpose step. Is automatically called by the transform methods, but may be needed when a newly created backend should be constructed directly in frequency space. </p>

</div>
</div>
<a id="a12ab172cecac4860fff4267ba4f7e3c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12ab172cecac4860fff4267ba4f7e3c7">&#9670;&nbsp;</a></span>update()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::update </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a705079851d4d4f0fbc2fe4d21125888e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a705079851d4d4f0fbc2fe4d21125888e">&#9670;&nbsp;</a></span>valid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Traits &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="a00914.html">parafields::R2CMatrixBackend</a>&lt; Traits &gt;::valid </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check whether matrix has already been created. </p>
<dl class="section return"><dt>Returns</dt><dd>true if the matrix data is present, else false </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="a00026_source.html">r2cmatrixbackend.hh</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
